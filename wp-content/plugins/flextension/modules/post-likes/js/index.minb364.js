(()=>{"use strict";const{flextension:t}=window;t.on("ready",((e,s)=>{s||(s=document),function(e){const s="flextLikes";let l=[];const o=!document.body.classList.contains("logged-in");if(o){const t=window.localStorage.getItem(s);l=t?t.split(",").map((t=>t.trim())):[],l=l.filter(((t,e,s)=>s.indexOf(t)===e))}e.querySelectorAll(".flext-post-likes").forEach((i=>{const n=i.dataset.postId;l.includes(n)&&(i.classList.remove("flext-like-button"),i.classList.add("flext-unlike-button")),i.addEventListener("click",(i=>{if(i.preventDefault(),!n)return;const a=e.querySelectorAll('.flext-post-likes[data-post-id="'+n+'"]');a.forEach((t=>{t.classList.add("flext-is-loading")}));let c="auto";if(o)if(l.includes(n)){c="remove";const t=l.indexOf(n);l.splice(t,1)}else c="add",l.push(n);t.ajax({method:"POST",data:{action:"flextension_post_likes",post:n,mode:c},callback:e=>{if(a.forEach((t=>{t.classList.remove("flext-is-loading")})),e){const i=parseInt(e.status,10);200===i?(o&&window.localStorage.setItem(s,l.join(",")),a.forEach((t=>{1===parseInt(e.button.status,10)?(t.classList.remove("flext-like-button"),t.classList.add("flext-unlike-button")):(t.classList.remove("flext-unlike-button"),t.classList.add("flext-like-button")),t.setAttribute("title",e.button.title),0===parseInt(e.message,10)?t.classList.add("is-empty"):t.classList.remove("is-empty");const s=t.querySelector("span");null!==s&&(s.innerHTML=e.message)}))):401===i&&(t.showLoginForm?t.showLoginForm():new t.lightbox("<p>"+e.message+"</p>",{className:"flext-post-likes-modal",fullscreen:!1}))}}})}))}))}(s)}))})();