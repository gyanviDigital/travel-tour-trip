(()=>{"use strict";const{flextension:e,URL:t,fetch:n,Headers:s}=window;function o(e){const t=[];return"object"==typeof e&&Object.keys(e).forEach((n=>{const s=e[n];"object"==typeof s?Object.keys(s).forEach((e=>{t.push(encodeURIComponent(n+"["+e+"]")+"="+encodeURIComponent(s[e]))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(s))})),t.join("&")}function a(t){if(this.settings=Object.assign({url:"",nonce:""},e.settings.api||{}),!this.settings.url)throw new Error("Invalid API URI.");t||(t=""),this.settings.url+=t,this.settings.url=this.settings.url.replace(/\/$/,"")}a.prototype.fetch=function(e,t,o){const a=new s(t?.headers||{});return a.has("Content-Type")||a.append("Content-Type","application/json"),this.settings.nonce&&a.append("X-WP-Nonce",this.settings.nonce),t=Object.assign({headers:a},t||{}),n(e,t).then((e=>{if(!0!==e.ok)throw new Error(`HTTP error! Status: ${e.status}`);{const t=e.headers.get("X-WP-Nonce");t&&this.settings.nonce!==t&&(this.settings.nonce=t)}return"function"==typeof o&&o(e),e.json()}))},a.prototype.get=function(e,n,s,a){const r=new t(this.settings.url+e);return new URLSearchParams(o(n)).forEach(((e,t)=>{r.searchParams.append(t,e)})),a=Object.assign({method:"GET"},a||{}),this.fetch(r,a,s)},a.prototype.post=function(e,n,s,o){const a=new t(this.settings.url+e);return o=Object.assign({method:"POST",body:JSON.stringify(n)},o||{}),this.fetch(a,o,s)},e.RestApi=a,e.api=new e.RestApi,e.ajax=({url:s,method:a,headers:r,data:c,callback:i})=>{a||(a="GET"),s||(s=e.settings.ajaxUrl),e.settings.ajaxNonce&&(c=Object.assign({},c,{ajaxNonce:e.settings.ajaxNonce}));const h={method:a,headers:Object.assign({},{"Content-Type":"application/x-www-form-urlencoded"},r),credentials:"same-origin"};return"GET"===a||"HEAD"===a?(s=new t(s),new URLSearchParams(o(c)).forEach(((e,t)=>{s.searchParams.append(t,e)}))):h.body=new URLSearchParams(c),n(s,h).then((e=>{const t=e.headers.get("content-type");return t&&t.includes("application/json")?e.json():e.text()})).then((e=>{"function"==typeof i&&i(e)}))}})();